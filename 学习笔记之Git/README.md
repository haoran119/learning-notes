# 学习笔记之Git

* [Git - Wikipedia](https://en.wikipedia.org/wiki/Git)
  * Git (/ɡɪt/) is a version control system for tracking changes in computer files and coordinating work on those files among multiple people. It is primarily used for source code management in software development, but it can be used to keep track of changes in any set of files. As a distributed revision control system it is aimed at speed, data integrity, and support for distributed, non-linear workflows.
* [Gitflow Workflow | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow)
  * [Gitflow Workflow is a Git workflow design that was first published and made popular by Vincent Driessen at nvie. The Gitflow Workflow defines a strict branching model designed around the project release. This provides a robust framework for managing larger projects. 
  * [Git cheat sheet | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/atlassian-git-cheatsheet)
* [Introducing GitFlow](https://datasift.github.io/gitflow/IntroducingGitFlow.html)
  * GitFlow is a branching model for Git, created by Vincent Driessen. It has attracted a lot of attention because it is very well suited to collaboration and scaling the development team.
* [Pull Requests and Gitflow](https://blog.axosoft.com/pull-requests-gitflow/?utm_campaign=GitKraken%20Promos&utm_medium=email&_hsenc=p2ANqtz--5kZ-hsMZwcIFWuqofU-Oa0iqSOfNS72XNKNaK7CpgtDt6A865oAJYYgDGwDy9KV3_VBTX1DzFJun_PtkOHa1HRm5ptQ&_hsmi=61804615&utm_content=61804282&utm_source=hs_email&hsCtaTracking=61c5ea4a-e8bd-4ffd-bdfa-7de19a1b53e1%7Cfba6e886-1dff-473b-8c6b-f5a02ebef2c2)
  * In my previous post, I discussed the Gitflow model and how it helps enterprises manage releases. In this post, I will be discussing pull requests and their importance in the development process.
* [TortoiseGit – Windows Shell Interface to Git](https://tortoisegit.org/)
  * TortoiseGit provides overlay icons showing the file status, a powerful context menu for Git and much more!
* [TortoiseGit - Wikipedia](https://en.wikipedia.org/wiki/TortoiseGit)
  * TortoiseGit is a Git revision control client, implemented as a Windows shell extension and based on TortoiseSVN. It is free software released under the GNU General Public License.
  * In Windows Explorer, besides showing context menu items for Git commands, TortoiseGit provides icon overlays that indicate the status of Git working trees and files.
  * It also comes with the TortoiseGitMerge utility to visually compare two files and resolve conflicts.
* [TortoiseGit - 维基百科，自由的百科全书](https://zh.wikipedia.org/wiki/TortoiseGit)
  * TortoiseGit是一个Git版本控制客户端，作为Microsoft Windows的外壳扩展实现。它在GNU通用公共许可协议下作为自由软件发布。

## RESROUCES
* [Git 教程 | 菜鸟教程](http://www.runoob.com/git/git-tutorial.html)
* [如何优雅地向别人介绍Git - 机器之心](https://mp.weixin.qq.com/s/79Aug3YQzS5-IuJlg46ukg)
  * 本文主题是如何向工具初学者介绍分布式版本控制系统 Git。除了了解关于 Git 的基本知识以外，大家还可以学到一些工具学习方面的东西。
  * https://rachelcarmena.github.io/2018/12/12/how-to-teach-git.html
* [一篇文章，教你学会Git](https://mp.weixin.qq.com/s?__biz=MzUyODg4Nzk2MQ==&mid=2247490430&amp;idx=3&amp;sn=b5e284cd5a5bb62da3819e29f0e29fa3&source=41#wechat_redirect)
  * https://www.jianshu.com/p/072587b47515
  * 一、Git工作流程
  * 二、常用Git命令
* [Git入门](https://mp.weixin.qq.com/s/kreK2FlQ31VP2303FbpQzQ)
  * 版本控制介绍
    * 什么是版本控制 为什么要版本控制 本地版本控制系统 集中化的版本控制系统
    * 分布式版本控制系统
  * 认识 Git
    * Git 简史
    * Git 与其他版本管理系统的主要区别
    * Git 的三种状态
  * Git 使用快速入门
    * 获取 Git 仓库
    * 记录每次更新到仓库
    * 推送改动到远程仓库
    * 远程仓库的移除与重命名
    * 查看提交历史
    * 撤销操作
    * 分支
  * 推荐阅读
* [Git原理入门解析](https://mp.weixin.qq.com/s/kw7fChfvLsfFYTgmO0-hsw)
* [20 分钟教你搞懂 Git！- 机器学习算法与Python学习](https://mp.weixin.qq.com/s/pyThc93faTz0N1gmHybFxw)
  1. 初始化
  2. 保存对象
  3. 更新索引
  4. git add命令
  5. 提交（Commit）
  6. 完成提交
  7. git commit命令
  8. 分支（branch）
  9. 更新分支
* [git 版本控制初学者指南](https://mp.weixin.qq.com/s/PAF365YSP-EOOlz6AzFkXA)
* [git 操作规范 - 程序猿](https://mp.weixin.qq.com/s/gshJ7HeHVCnUjTssJYeSSw)
  * https://segmentfault.com/a/1190000014461898
  * 一、 创建与合并分支
  * 二、 解决冲突
  * 三、Bug分支
  * 四、版本回退
  * 五、撤销修改
  * 六、对于已经push的版本，进行回退
  * 七、本地同步远程删除的分支
  * 八、删除掉没有与远程分支对应的本地分支
  * 九、查看远程库的一些信息，及与本地分支的信息
  * 十、git stash临时保存本地操作
* [你可能会忽略的 Git 提交规范 - Linux学习](https://mp.weixin.qq.com/s/alHVVwRQ1Cu9vb3vOqSNgQ)
  * http://jartto.wang/2018/07/08/git-commit/
* [大厂 Git 提交规范](https://mp.weixin.qq.com/s/ouJlkTFu8DEEb6HelqHiVA)
  * https://juejin.im/post/5d0b3f8c6fb9a07ec07fc5d0
* [Git 分支设计规范](https://mp.weixin.qq.com/s/6d6r-Z86mxvuUfFtT2cetg)

## COMMANDS

### [git add](https://git-scm.com/docs/git-add)

* git-add - Add file contents to the index
* [Git Add | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/saving-changes)
```sh
git add <file>
git add <directory>
# Begin an interactive staging session that lets you choose portions of a file to add to the next commit. 
# This will present you with a chunk of changes and prompt you for a command. Use y to stage the chunk, 
# n to ignore the chunk, s to split it into smaller chunks, e to manually edit the chunk, and q to exit.
git add -p
# create an initial commit of the current directory
git add .
```

### [git blame](https://git-scm.com/docs/git-blame)

* git-blame - Show what revision and author last modified each line of a file

### [git branch](https://git-scm.com/docs/git-branch)

* git-branch - List, create, or delete branches
```sh
git branch [--color[=<when>] | --no-color] [--show-current]
	[-v [--abbrev=<n> | --no-abbrev]]
	[--column[=<options>] | --no-column] [--sort=<key>]
	[--merged [<commit>]] [--no-merged [<commit>]]
	[--contains [<commit>]] [--no-contains [<commit>]]
	[--points-at <object>] [--format=<format>]
	[(-r | --remotes) | (-a | --all)]
	[--list] [<pattern>…]
git branch [--track[=(direct|inherit)] | --no-track] [-f]
	[--recurse-submodules] <branchname> [<start-point>]
git branch (--set-upstream-to=<upstream> | -u <upstream>) [<branchname>]
git branch --unset-upstream [<branchname>]
git branch (-m | -M) [<oldbranch>] <newbranch>
git branch (-c | -C) [<oldbranch>] <newbranch>
git branch (-d | -D) [-r] <branchname>…
git branch --edit-description [<branchname>]
```
* -a / --all
  * List both remote-tracking branches and local branches. Combine with --list to match optional pattern(s).
* -l / --list
  * List branches. With optional `<pattern>`..., e.g. `git branch --list 'maint-*'`, list only the branches that match the pattern(s).
* Start development from a known tag
  * 1. This step and the next one could be combined into a single step with "checkout -b my2.6.14 v2.6.14".
```sh
$ git clone git://git.kernel.org/pub/scm/.../linux-2.6 my2.6
$ cd my2.6
$ git branch my2.6.14 v2.6.14   (1)
$ git switch my2.6.14
```
* Delete an unwanted branch
  * 1. Delete the remote-tracking branches "todo", "html" and "man". The next fetch or pull will create them again unless you configure them not to. See git-fetch[1].
  * 2. Delete the "test" branch even if the "master" branch (or whichever branch is currently checked out) does not have all commits from the test branch.
```sh
$ git clone git://git.kernel.org/.../git.git my.git
$ cd my.git
$ git branch -d -r origin/todo origin/html origin/man   (1)
$ git branch -D test                                    (2)
```
* [How do I delete a Git branch locally and remotely? - Stack Overflow](https://stackoverflow.com/questions/2003505/how-do-i-delete-a-git-branch-locally-and-remotely#targetText=Simply%20do%20git%20push%20origin,local%20branch%20ONLY!...)
    * Executive Summary
        * Note that in most cases the remote name is origin.
        ```sh
        $ git push --delete <remote_name> <branch_name>
        $ git branch -d <branch_name>
        ```
    * Delete Local Branch
        * To delete the local branch use one of the following:
        * Note: The -d option is an alias for --delete, which only deletes the branch if it has already been fully merged in its upstream branch. You could also use -D, which is an alias for --delete --force, which deletes the branch "irrespective of its merged status." [Source: man git-branch]
        ```sh
        $ git branch -d branch_name
        $ git branch -D branch_name
        ```
    * Or delete remote branch on git web first, e.g. github, then run `git fetch --all --prune` locally to update local branch  
* [Rename a local and remote branch in git – Multiple States Knowledge Base](https://multiplestates.wordpress.com/2015/02/05/rename-a-local-and-remote-branch-in-git/)
  * Rename your local branch.
    * If you are on the branch you want to rename:
    ```sh
    $ git branch -m new-name
    ```
    * If you are on a different branch:
    ```sh
    $ git branch -m old-name new-name
    ```
  * Delete the old-name remote branch and push the new-name local branch.
  ```sh
  $ git push origin :old-name new-name
  ```
  * Reset the upstream branch for the new-name local branch.
    * Switch to the branch and then:
    ```sh
    $ git push origin -u new-name
    ```

### [git bundle](https://git-scm.com/docs/git-bundle)

* git-bundle - Move objects and refs by archive
```sh
$ git bundle create mybundle v1.0.0..master
```

### [git checkout](https://git-scm.com/docs/git-checkout)

* git-checkout - Switch branches or restore working tree files
```sh
git checkout [-q] [-f] [-m] [<branch>]
git checkout [-q] [-f] [-m] --detach [<branch>]
git checkout [-q] [-f] [-m] [--detach] <commit>
git checkout [-q] [-f] [-m] [[-b|-B|--orphan] <new-branch>] [<start-point>]
git checkout [-f|--ours|--theirs|-m|--conflict=<style>] [<tree-ish>] [--] <pathspec>…
git checkout [-f|--ours|--theirs|-m|--conflict=<style>] [<tree-ish>] --pathspec-from-file=<file> [--pathspec-file-nul]
git checkout (-p|--patch) [<tree-ish>] [--] [<pathspec>…]
```
* Updates files in the working tree to match the version in the index or the specified tree. If no pathspec was given, `git checkout` will also update `HEAD` to set the specified branch as the current branch.
* `git checkout [<branch>]`
  * To prepare for working on `<branch>`, switch to it by updating the index and the files in the working tree, and by pointing `HEAD` at the branch. Local modifications to the files in the working tree are kept, so that they can be committed to the `<branch>`.
  * If `<branch>` is not found but there does exist a tracking branch in exactly one remote (call it `<remote>`) with a matching name and `--no-guess` is not specified, treat as equivalent to
    * `$ git checkout -b <branch> --track <remote>/<branch>`
  * You could omit `<branch>`, in which case the command degenerates to "check out the current branch", which is a glorified no-op with rather expensive side-effects to show only the tracking information, if exists, for the current branch.
* `git checkout -b|-B <new-branch> [<start-point>]`
  * Specifying `-b` causes a new branch to be created as if git-branch[1] were called and then checked out. In this case you can use the `--track` or `--no-track` options, which will be passed to git branch. As a convenience, `--track` without `-b` implies branch creation; see the description of `--track` below.
  * If `-B` is given, `<new-branch>` is created if it doesn’t exist; otherwise, it is reset. This is the transactional equivalent of
    * `$ git branch -f <branch> [<start-point>]`
    * `$ git checkout <branch>`
  * that is to say, the branch is not reset/created unless "git checkout" is successful.
* How to create a local branch from master ?
```sh
$ git fetch
$ git checkout master
$ git checkout -b local_branch
```
* How to create a local branch to track remote branch ?
  * This will create a new local branch named "local" that is based on the "remote" branch. The "-b" option specifies that you want to create a new branch, and the "origin/remote" argument specifies the remote branch that you want to base your new branch on.
  * Once you have created the new branch, you can start making changes to your code and committing them to the new branch as you normally would. Note that the new branch will only exist locally until you push it to a remote repository using `git push`.
```sh
$ git fetch
# Create a new local branch named "local" that tracks the "remote" branch
$ git checkout -b local_branch origin/remote_branch
```
* The following sequence checks out the master branch, reverts the Makefile to two revisions back, deletes hello.c by mistake, and gets it back from the index.
```sh
$ git checkout master
$ git checkout master~2 Makefile
$ rm -f hello.c
$ git checkout hello.c
```
* [Resetting, Checking Out & Reverting | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/resetting-checking-out-and-reverting)
* How to revert to a previous commit ?
  * [git checkout - How do I revert a Git repository to a previous commit? - Stack Overflow](https://stackoverflow.com/questions/4114095/how-do-i-revert-a-git-repository-to-a-previous-commit)
  ```sh
  # This will detach your HEAD, that is, leave you with no branch checked out:
  git checkout 0d1d7fc32
  ```
  
### [git cherry-pick](https://git-scm.com/docs/git-cherry-pick)

* git-cherry-pick - Apply the changes introduced by some existing commits
* How to restore lost commits ?
  * [Git Cherry Pick | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/cherry-pick)
```sh
$ git fetch
$ git cherry-pick ***
```

### [git clone](https://git-scm.com/docs/git-clone)

* git-clone - Clone a repository into a new directory
```sh
$ git clone git://git.kernel.org/pub/scm/.../linux.git my-linux
```

### [git commit](https://git-scm.com/docs/git-commit)

* git-commit - Record changes to the repository
* [Git Commit | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/saving-changes/git-commit#:~:text=The%20git%20commit%20command%20captures,you%20explicitly%20ask%20it%20to.)
  * A power user shortcut command that combines the -a and -m options. This combination immediately creates a commit of all the staged changes and takes an inline commit message.
```sh
$ git commit -am "commit message"
```
* How to amend last commit on remote ?
  * It is generally `not recommended to amend the last commit on a remote repository` since it can cause issues for other users who have already cloned or pulled the repository. However, if you need to do this for some reason, you can follow these steps:
  * Make sure you have the latest version of the remote repository by pulling the changes: `git pull origin <branch-name>`.
  * Create a new commit with the changes you want to amend to the previous commit using the command `git commit --amend`. This will open up the default editor with the last commit message. You can make changes to the message or keep it as it is.
  * After making any changes to the commit message, save the file and exit the editor.
  * Push the changes to the remote repository using the `--force` option to overwrite the previous commit: `git push --force origin <branch-name>`.
  * Note that using `--force` to overwrite a commit on a remote repository can cause issues for other users who have already pulled the repository, as it will rewrite the repository history. It is generally recommended to avoid using `--force` unless absolutely necessary, and to communicate with other users before making such changes.

### [git config](https://git-scm.com/docs/git-config)

* git-config - Get and set repository or global options
* [git config | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/setting-up-a-repository/git-config)
  * In this document, we'll take an in-depth look at the git config command. We briefly discussed git config usage on our Setting up a Repository page. The git config command is a convenience function that is used to set Git configuration values on a global or local project level. These configuration levels correspond to .gitconfig text files. Executing git config will modify a configuration text file. We'll be covering common configuration settings like email, username, and editor. We'll discuss Git aliases, which allow you to create shortcuts for frequently used Git operations. Becoming familiar with git config and the various Git configuration settings will help you create a powerful, customized Git workflow.
  * [credentials - How can I save username and password in Git? - Stack Overflow](https://stackoverflow.com/questions/35942754/how-can-i-save-username-and-password-in-git#:~:text=So%2C%20the%20full%20command%20will,encryption%2C%20so%20to%20say)
```sh
$ git config --global user.name "name"
$ git config --global user.email "name@test.com"
$ git config --list

# Disable SSL validation
$ git config --global http.sslVerify false

# Cache credentials
$ git config --global credential.helper wincred

# Turn off auto-converting CRLF line endings into LF
$ git config --global core.autocrlf false
```

### [git diff](https://git-scm.com/docs/git-diff)

* git-diff - Show changes between commits, commit and working tree, etc
* [Git Diff | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/saving-changes/git-diff)
  * Comparing files: git diff file
  ```sh
  $ git diff master ./diff_test.txt
  ```
  * Comparing two branches
  ```sh
  $ git diff master new_branch
  ```
  * Comparing files from two branches
  ```sh
  $ git diff master new_branch ./diff_test.txt　　
  ```
* How to create and apply changes in working directory ?
  * [Create a git patch from the changes in the current working directory - Stack Overflow](https://stackoverflow.com/questions/5159185/create-a-git-patch-from-the-changes-in-the-current-working-directory)
    * If you haven't yet commited the changes, then:
    ```sh
    $ git diff > mypatch.patch
    ```
    * But sometimes it happens that part of the stuff you're doing are new files that are untracked and won't be in your git diff output. So, one way to do a patch is to stage everything for a new commit (git add each file, or just git add .) but don't do the commit, and then:
    ```sh
    $ git diff --cached > mypatch.patch
    ```
    * Add the 'binary' option if you want to add binary files to the patch (e.g. mp3 files):
    ```sh
    $ git diff --cached --binary > mypatch.patch
    ```
    * You can later apply the patch:
    ```sh
    $ git apply mypatch.patch
    ```
    * Note: You can also use --staged as a synonym of --cached.

### [git fetch](https://git-scm.com/docs/git-fetch)

* git-fetch - Download objects and refs from another repository
    * -p
    * --prune
        * Before fetching, remove any remote-tracking references that no longer exist on the remote. Tags are not subject to pruning if they are fetched only because of the default tag auto-following or due to a --tags option. However, if tags are fetched due to an explicit refspec (either on the command line or in the remote configuration, for example if the remote was cloned with the --mirror option), then they are also subject to pruning. Supplying --prune-tags is a shorthand for providing the tag refspec.
        * See the PRUNING section below for more details.
```sh
# Update the remote-tracking branches:
$ git fetch origin
# The above command copies all branches from the remote refs/heads/ namespace and stores them to the local 
# refs/remotes/origin/ namespace, unless the remote.<repository>.fetch option is used to specify a non-default refspec.
```

### [git gui](https://git-scm.com/docs/git-gui)
  
* git-gui - A portable graphical interface to Git

### [gitk](https://git-scm.com/docs/gitk)

* gitk - The Git repository browser
* [Git - gitk and git-gui | git Tutorial](https://riptutorial.com/git/example/18336/gitk-and-git-gui)

### [git log](https://git-scm.com/docs/git-log)

* git-log - Show commit logs
* [Advanced Git Log | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/git-log)
* The advanced features of git log can be split into two categories: formatting how each commit is displayed, and filtering which commits are included in the output.
```sh
$ git log -5
$ git log --after='2019-8-8'
```

### [git merge](https://git-scm.com/docs/git-merge)

* git-merge - Join two or more development histories together
```sh
git merge [-n] [--stat] [--no-commit] [--squash] [--[no-]edit]
	[--no-verify] [-s <strategy>] [-X <strategy-option>] [-S[<keyid>]]
	[--[no-]allow-unrelated-histories]
	[--[no-]rerere-autoupdate] [-m <msg>] [-F <file>]
	[--into-name <branch>] [<commit>…]
git merge (--continue | --abort | --quit)

# Merge branch maint into the current branch, but do not make a new commit automatically:
git merge --no-commit maint
# This can be used when you want to include further changes to the merge, or want to write your own merge commit message.
# You should refrain from abusing this option to sneak substantial changes into a merge commit. 
# Small fixups like bumping release/version name would be acceptable.
```
* Merging vs Rebasing
    * [Merging vs. Rebasing | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/merging-vs-rebasing)
        * The Merge Option
            * The easiest option is to merge the `main` branch into the `feature` branch using something like the following:
            ```sh
            git checkout feature
            git merge main
            
            # Or, you can condense this to a one-liner:
            git merge feature main
            ```
            * This creates a new “merge commit” in the `feature` branch that ties together the histories of both branches
            * Merging is nice because it’s a `non-destructive` operation. The existing branches are not changed in any way. This avoids all of the potential pitfalls of rebasing (discussed below).
            * On the other hand, this also means that the `feature` branch will have an extraneous merge commit every time you need to incorporate upstream changes. If `main` is very active, this can pollute your feature branch’s history quite a bit. While it’s possible to mitigate this issue with advanced `git log` options, it can make it hard for other developers to understand the history of the project.
        * The Rebase Option
            * As an alternative to merging, you can rebase the `feature` branch onto `main` branch using the following commands:
            ```sh
            git checkout feature
            git rebase main
            ```
            * This moves the entire `feature` branch to begin on the tip of the `main` branch, effectively incorporating all of the new commits in `main`. But, instead of using a merge commit, rebasing `re-writes` the project history by creating brand new commits for each commit in the original branch.
            * `The major benefit of rebasing is that you get a much cleaner project history.` First, it eliminates the unnecessary merge commits required by `git merge`. Second, as you can see in the above diagram, rebasing also results in a perfectly linear project history—you can follow the tip of `feature` all the way to the beginning of the project without any forks. This makes it easier to navigate your project with commands like `git log`, `git bisect`, and `gitk`.
            * `But, there are two trade-offs for this pristine commit history: safety and traceability.` If you don’t follow the [Golden Rule of Rebasing](https://www.atlassian.com/git/tutorials/merging-vs-rebasing#the-golden-rule-of-rebasing), re-writing project history can be potentially catastrophic for your collaboration workflow. And, less importantly, rebasing loses the context provided by a merge commit—you can’t see when upstream changes were incorporated into the feature.
        * The Golden Rule of Rebasing
            * Once you understand what rebasing is, the most important thing to learn is when `not` to do it. `The golden rule of git rebase is to never use it on public branches.`
            * Force-Pushing
                * If you try to push the rebased `main` branch back to a remote repository, Git will prevent you from doing so because it conflicts with the remote `main` branch. But, you can force the push to go through by passing the `--force` flag, like so:
                * `Be very careful with this command! git push --force`
                * This overwrites the remote `main` branch to match the rebased one from your repository and makes things very confusing for the rest of your team. `So, be very careful to use this command only when you know exactly what you’re doing.`
                * One of the only times you should be force-pushing is when you’ve performed a local cleanup `after` you’ve pushed a private feature branch to a remote repository (e.g., for backup purposes). This is like saying, “Oops, I didn’t really want to push that original version of the feature branch. Take the current one instead.” `Again, it’s important that nobody is working off of the commits from the original version of the feature branch.`
    * [Learn Git: Merging vs Rebasing](https://blog.axosoft.com/learn-git-merging-rebasing/)
        * In this quick Git tutorial video, we’ll answer the question, “What’s the difference between merging and rebasing in Git?”
* How to merge feature branch into master ?
  * Swtich to feature branch and rebase
  ```sh
  $ git fetch
  $ git checkout feature/xxx
  # note that git rebase origin/master may mess up the branch history
  $ git rebase --preserve-merges origin/master
  $ git push -f origin feature/xxx
  ```
  * Squash commits
  ```sh
  $ git rebase -i HEAD~7 # change 7 to the actual number of commits
  # In the interactive mode, keep the top one commit, and change others from pick to s
  $ git push -f origin feature/xxx
  ```
  * Swtich to master branch
  ```sh
  $ git checkout master
  $ git pull
  ```
  * Merge feature branch
  ```sh
  $ git merge --no-ff feature/xxx
  ```
  * Check the merge locally
  ```sh
  $ gitk
  ```
  * If it looks wrong, reset the changes
  ```sh
  $ git reset --hard origin/master
  ```
  * Push merge to server
  ```sh
  $ git push origin master
  ```
  * Check git tag
  ```sh
  $ git fetch --tags
  $ git describe
  ```
* How to merge feature branch with conflict ?
  * [Resolve merge conflicts - Atlassian Documentation](https://confluence.atlassian.com/bitbucket/resolve-merge-conflicts-704414003.html)
  * [Solved: How can I solve a conflict in a pull request?](https://community.atlassian.com/t5/Bitbucket-questions/How-can-I-solve-a-conflict-in-a-pull-request/qaq-p/577205)
  * [The Git experience in Visual Studio | Microsoft Docs](https://docs.microsoft.com/en-us/visualstudio/version-control/git-with-visual-studio?view=vs-2022)
    * [Manage Git repos in Visual Studio | Microsoft Docs](https://docs.microsoft.com/en-us/visualstudio/version-control/git-manage-repository?view=vs-2022)
    * [Resolve merge conflicts in Visual Studio | Microsoft Docs](https://docs.microsoft.com/en-us/visualstudio/version-control/git-resolve-conflicts?view=vs-2022)
  * Tips : do it in VScode to just accecpt or reject conflicts for more convenient

### [git mv](https://git-scm.com/docs/git-mv)

* git-mv - Move or rename a file, a directory, or a symlink
```sh
$ git mv old.py new.py
```

### [git pull](https://git-scm.com/docs/git-pull)

* git-pull - Fetch from and integrate with another repository or a local branch
  * OPTIONS
    * -r
    * --rebase[=false|true|merges|interactive]
      * When true, rebase the current branch on top of the upstream branch after fetching. If there is a remote-tracking branch corresponding to the upstream branch and the upstream branch was rebased since last fetched, the rebase uses that information to avoid rebasing non-local changes.
      * When set to merges, rebase using git rebase --rebase-merges so that the local merge commits are included in the rebase (see git-rebase[1] for details).
      * When false, merge the upstream branch into the current branch.
      * When interactive, enable the interactive mode of rebase.
```sh
git pull [<options>] [<repository> [<refspec>…]]

# Merge into the current branch local_branch the remote branch remote_branch
git checkout local_branch
git pull origin remote_branch

# This leaves a copy of remote_branch temporarily in FETCH_HEAD, and updates the remote-tracking branch 
# origin/remote_branch. 
# The same can be done by invoking fetch and merge:
git fetch origin
git merge origin/remote_branch

# If you tried a pull which resulted in complex conflicts and would want to start over, you can recover with git reset.

# !BE CAREFUL! pull changes from remote and rebase the current branch on top of the upstream branch after fetching.
git pull --rebase origin master
```

### [git push](https://git-scm.com/docs/git-push)

* git-push - Update remote refs along with associated objects
* [Git Push | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/syncing/git-push)
```sh
# Find a ref that matches master in the source repository (most likely, it would find refs/heads/master), 
# and update the same ref (e.g. refs/heads/master) in origin repository with it. 
# If master did not exist remotely, it would be created.
$ git push origin master

$ git push --progress "origin" local_branch1:branch1
```
* How to push from a detached head ?
  * [Making a Git push from a detached head - Stack Overflow](https://stackoverflow.com/questions/35736116/making-a-git-push-from-a-detached-head)
  * [git - Updates were rejected because the tip of your current branch is behind its remote counterpart - Stack Overflow](https://stackoverflow.com/questions/39399804/updates-were-rejected-because-the-tip-of-your-current-branch-is-behind-its-remot)
  ```sh
  git checkout -b BRANCH_NAME
  git push origin BRANCH_NAME
  ```

### [git rebase](https://git-scm.com/docs/git-rebase)

* git-rebase - Reapply commits on top of another base tip
* How to sync up feature branch with master branch code changes ?
  * Do git rebase to pick up the master branch code changes.
  * `Be careful to use if branch has already pushed to remote`
  ```sh
  $ git fetch
  $ git checkout feature/xxx
  $ git rebase origin/master
  
  # If any issues, fix it and continue 
  $ git mergetool
  $ git rebase --continue

  $ git push -f origin feature/xxx
  ```
  * [git rebase | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/rewriting-history/git-rebase)
  * [An introduction to Git merge and rebase: what they are, and how to use them](https://www.freecodecamp.org/news/an-introduction-to-git-merge-and-rebase-what-they-are-and-how-to-use-them-131b863785f/#:~:text=Rebase%20is%20another%20way%20to,from%20one%20branch%20to%20another. )
* How to squash commits into one commit ?
  * Do git rebase -i to squash commits interactively. 
  ```sh
  $ git fetch
  $ git checkout feature/xxx
  $ git rebase -i HEAD~7 # change 7 to the actual number of commits
  ```
  * Keep the top commit, and change others to 's' for squashing
  * [Git - Rewriting History](https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History)

### [git remote](https://git-scm.com/docs/git-remote)

* Manage the set of repositories ("remotes") whose branches you track.
* [Managing remote repositories - GitHub Docs](https://docs.github.com/en/get-started/getting-started-with-git/managing-remote-repositories)
    * Learn to work with your local repositories on your computer and remote repositories hosted on GitHub.
```sh
$ git remote add origin https://github.com/USER/REPO.git
# Set a new remote
$ git remote set-url origin https://github.com/USERNAME/REPOSITORY.git
$ git remote -v
# Verify new remote
> origin  https://github.com/USER/REPO.git (fetch)
> origin  https://github.com/USER/REPO.git (push)
```
       
### [git reset](https://git-scm.com/docs/git-reset)

* git-reset - Reset current HEAD to the specified state
* --hard
  * Resets the index and working tree. Any changes to tracked files in the working tree since `<commit>` are discarded. Any untracked files or directories in the way of writing any tracked files are simply deleted.
```sh
$ git reset HEAD test.py

# reset your local branch to match the state of the origin/master branch in the remote repository 
# and discard any local changes that are not in the remote branch.
$ git reset --hard origin/master

# Undo commits permanently
$ git commit ...
$ git reset --hard HEAD~3   (1)
# The last three commits (HEAD, HEAD^, and HEAD~2) were bad and you do not want to ever see them again. 
# Do not do this if you have already given these commits to somebody else. 
# (See the "RECOVERING FROM UPSTREAM REBASE" section in git-rebase[1] for the implications of doing so.)
```
* How to delete a local commit?
    * To delete a local commit in Git, you can use the git reset command. Here are the steps:
        * Use `git log` to find the commit ID of the local commit you want to delete.
        * Use `git reset HEAD~` to remove the most recent commit from your local branch. If you want to delete a specific commit, `replace HEAD~ with the commit ID`.
        * Optionally, use `git reset --hard HEAD~` to remove the commit and discard any changes made in that commit. This command will remove the commit and reset your working directory to the state it was in before the commit was made.
        * Use `git push -f` to force push the updated branch to the remote repository if the commit has already been pushed to the remote repository.
        * Note that deleting a local commit can be risky if the commit has already been pushed to a remote repository and other developers are working on the same branch. It is recommended to communicate with other developers and consider the potential impact of deleting a commit before doing so.

### [git revert](https://git-scm.com/docs/git-revert)

* git-revert - Revert some existing commits
* SYNOPSIS
    * `git revert [--[no-]edit] [-n] [-m <parent-number>] [-s] [-S[<keyid>]] <commit>…​`
    * `git revert (--continue | --skip | --abort | --quit)`
* OPTIONS
    * -m parent-number --mainline parent-number
        * Usually you cannot revert a merge because you do not know which side of the merge should be considered the mainline. This option specifies the parent number (starting from 1) of the mainline and allows revert to reverse the change relative to the specified parent.
        * Reverting a merge commit declares that you will never want the tree changes brought in by the merge. As a result, later merges will only bring in tree changes introduced by commits that are not ancestors of the previously reverted merge. This may or may not be what you want.
        * See the [revert-a-faulty-merge How-To](https://git-scm.com/docs/howto/revert-a-faulty-merge) for more details.
    * -n --no-commit
        * Usually the command automatically creates some commits with commit log messages stating which commits were reverted. This flag applies the changes necessary to revert the named commits to your working tree and the index, but does not make the commits. In addition, when this option is used, your index does not have to match the HEAD commit. The revert is done against the beginning state of your index.
        * This is useful when reverting more than one commits' effect to your index in a row.
```sh
$ git revert HEAD~3
# Revert the changes specified by the fourth last commit in HEAD and create a new commit with the reverted changes.

$ git revert -n master~5..master~2
# Revert the changes done by commits from the fifth last commit in master (included) to the third last commit in master
# (included), but do not create any commit with the reverted changes. The revert only modifies the working tree and the index

# Revert the changes but don't create a commit yet
$ git revert -n abc123

# Commit the changes with a new message
$ git commit -m "Your new commit message here"
```
* How to fix `error: commit xxx is a merge but no -m option was given.`?
    * When you try to revert a merge commit, Git needs to know which parent of the merge you want to consider the mainline. This is what the -m option is for.
    * If you get the error that -m was not given, it's because you're trying to revert a merge commit. You can use -m 1 or -m 2 to specify which parent is the mainline. Here's how to do it:
        * `git revert -n -m 1 <commit-hash>`
        * or
        * `git revert -n -m 2 <commit-hash>`
    * The parent number is determined by the order they were committed. For example, if your commit history looks like this:
    ```sh
    A - B - C - D - E (master)
         \         /
          1 - 2 - 3 (feature)
    ```
    * If E is the merge commit and you want to consider D as the mainline (i.e., keep the changes from D and remove the changes introduced by 3), you should use -m 1 because D was committed before 3. Conversely, if you want to consider 3 as the mainline, you should use -m 2.
    * After running the `git revert -n -m` command, you can commit the changes with a new message using `git commit -m "Your new commit message here"`.

### [git rm](https://git-scm.com/docs/git-rm)

* git-rm - Remove files from the working tree and from the index
```sh
$ git rm Documentation/\*.txt
# Removes all *.txt files from the index that are under the Documentation directory and any of its 
# subdirectories.
# Note that the asterisk * is quoted from the shell in this example; this lets Git, and not the shell, 
# expand the pathnames of files and subdirectories under the Documentation/ directory.

$ git rm -f git-*.sh
# Because this example lets the shell expand the asterisk (i.e. you are listing the files explicitly), 
# it does not remove subdir/git-foo.sh.
```

### [git stash](https://git-scm.com/docs/git-stash)

* git-stash - Stash the changes in a dirty working directory away
* [git stash - Saving Changes | Atlassian Git Tutorial](https://www.atlassian.com/git/tutorials/saving-changes/git-stash)
  * git stash temporarily shelves (or stashes) changes you've made to your working copy so you can work on something else, and then come back and re-apply them later on. Stashing is handy if you need to quickly switch context and work on something else, but you're mid-way through a code change and aren't quite ready to commit.
  ```sh
  $ git stash save "for debug use only" 
  $ git stash list
  $ git pull
  $ git stash pop
  ```

## BEST PRACTICE

* [Git 12 岁了，为你送上 12 个 Git 的使用技巧！ - Linux学习](https://mp.weixin.qq.com/s/JZGmwYGp9ZGjYJfTu7SVJQ)
  * https://www.oschina.net/translate/12-git-tips-gits-12th-birthday
  1. 你的 ~/.gitconfig 文件
  2. 你的仓库的.gitconfig文件
  3. 别名
  4. shell命令中的别名
  5. 可视化提交图
  6. 更优雅的强制推送(force-push)
  7. git add -N
  8. git add -p
  9. git checkout -p
  10. Rebase with command execution
  11. 基于时间修改的指南
  12. 全知的 reflog
* [10种Git技巧，让你省时省力又省心！](https://mp.weixin.qq.com/s?__biz=MzIxODM4MjA5MA==&mid=2247490747&idx=1&sn=659415dda67813229d9e22ea6f3feb3a&chksm=97ea36dea09dbfc8403ac08354fc2e424d129535514b3d5e5437cf09066b32967ef0221f43bb&mpshare=1&scene=24&srcid=&sharer_sharetime=1567921736480&sharer_shareid=5ed4a849fa42d9599a974fa8eb45e8fa&key=5a37b8e9f2933463edafcb746a6bb5f5b98d6bcf34bfab0e92617ea276b27583fd9174edd408a53d07c8d1153ad57172c3953e572d1828a5f393ba9ef49571900ad79539ef29f6bbbe1a03beeb200e71&ascene=14&uin=MTMzMzc3MjY4MQ%3D%3D&devicetype=Windows+10&version=62060833&lang=en&pass_ticket=tT3maEfznKd3xtVT4L8%2Bl%2B2KKdhrJZ3ERaWEoIpqIMB2I2ssKo%2BTfx0v80L7rMTL)
* [你可能不太会用的10个Git命令 - 机器之心](https://mp.weixin.qq.com/s/2K8coqrcCajUtzx67jlZYg)
  * https://towardsdatascience.com/learn-enough-git-to-be-useful-281561eef959
* [20 个最常用的 Git 命令用法说明及示例](https://mp.weixin.qq.com/s/acP4yklWYf5TwOrLB41JYg)
  * https://dzone.com/articles/top-20-git-commands-with-examples
* [工作流一目了然，动图展示 10 大 Git 命令](https://mp.weixin.qq.com/s/xsQ_YKgPFpqxV8ju-K1BsQ)
  * https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1
* [常用的Git命令清单](https://mp.weixin.qq.com/s/r68M3qQ3Ed1J5ge1kLxrYQ)
  * https://blog.csdn.net/dqy19901103/article/details/107380601
* [团队开发中的 Git 实践](https://mp.weixin.qq.com/s/Jo8Z7EqNUiQD9VSOKXQUKQ)
  * https://ourai.ws/posts/working-with-git-in-team/
* [这有一份 Git 日常使用清单](https://mp.weixin.qq.com/s/DtHfpMy5O6pGzP40m4HJ3Q)
  * https://juejin.im/post/5d5b4c6951882569eb570958
* [Git 各指令的本质，真是通俗易懂啊](https://mp.weixin.qq.com/s/KHVbPzzrLtafyeDbiadfng)
  * https://juejin.cn/post/6895246702614806542
  * 1. 基本概念
    * 1.1 Git的优势
    * 1.2 文件状态
    * 1.3 commit 节点
    * 1.4 HEAD
    * 1.5 远程仓库
  * 2. 分支
    * 2.1 什么是分支？
  * 3. 命令详解
    * 3.1 提交相关
    * 3.2 分支相关
    * 3.3 合并相关
    * 3.4 回退相关
    * 3.5 远程相关
  * 不管是HEAD还是分支，它们都只是引用而已，引用+节点是 Git 构成分布式的关键
  * merge相比于rebase有更明确的时间历史，而rebase会使提交更加线性应当优先使用
  * 通过移动HEAD可以查看每个提交对应的代码
  * clone或fetch都会将远程仓库的所有提交、引用保存在本地一份
  * pull的本质其实就是fetch+merge，也可以加入--rebase通过rebase方式合并
* [Git 提交错了不用慌，这三招帮你修改记录](https://mp.weixin.qq.com/s/xtol-m1QDJPlJE74cBUAeQ)
  * 修改最后一次提交
  * 修改多个信息
  * 顺序变更、合并、拆分
  * 最后的最后，大家需要注意，虽然这些手段在修改记录的时候非常好用。但是如果这些 commit 已经被提交到了远程，我们是不可以直接 git push 同步的。因为 git 会校验我们提交的 hash 值，发现对不上之后会禁止我们的提交。所以如果想要提交到远程的话，只能使用 git push -f 强制覆盖。但是这是一个非常非常危险的操作，如果你 git push -f 了，没有人会知道你到底修改了什么，只建议在自己独有的分支上如此操作，一定一定要谨慎使用。
* [通过 .git 目录深入理解 Git！](https://mp.weixin.qq.com/s/q6tI0qctvciJhNz_5KLx-w)
  * https://www.daolf.com/posts/git-series-part-1/

## FAQ


# END
